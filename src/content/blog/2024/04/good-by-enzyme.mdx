---
title: "Goodbye Enzyme"
description: "You won't be missed..."
pubDate: "2024-04-08"
tags:
    [
        "frontend",
        "javascript",
        "typescript",
        "react",
        "enzyme",
        "react testing library",
    ]
---

<style>
    {`.twitter-tweet {
    margin-left: auto;
    margin-right: auto;
`}
</style>

import { Tweet } from "@astro-community/astro-embed-twitter";

I've showed my age in the [previous post](./snapshot-testing-sucks.md), so I won't do it again. But, for the
purposes of this post, I will say that I've been a professional in the industry prior to [Enzyme](https://enzymejs.github.io/enzyme/),
during its height, and after it (i.e. now).

This leads me to say, using my _expert_ opinion, "Goodbye Enzyme, and good riddance. You will not be missed."

That may seem harsh, but I firmly believe it. I've recently removed Enzyme from multiple, highly used codebases at my work
and have see the horrors caused by Enzyme. I'll cover some of these in this article, comparing it to [React Testing Library](https://testing-library.com/docs/react-testing-library/intro/).

## Enzyme? React Testing Library (RTL)? What are they?

They are both testing frameworks aiming to make it easier to test React components. They both have their own philosophies
and ways of doing things.

### Enzyme

> Enzyme is a JavaScript Testing utility for React that makes it easier to test your React Components' output.
> You can also manipulate, traverse, and in some ways simulate runtime given the output.

## RTL

> You want to write maintainable tests that give you high confidence that your components are working for your users.
> As a part of this goal, you want your tests to avoid including implementation details so refactors of your components
> (changes to implementation but not functionality) don't break your tests and slow you and your team down.

<Tweet id="https://twitter.com/kentcdodds/status/977018512689455106" />

These differing philosophies are the main reason why I prefer RTL over Enzyme. Enzyme is more focused on the "output" of
a component. Additionally, they talk about traversing, manipulating, and simulating the output, which does not align
with how actual users would be interacting with it.

On the other hand, RTL is more focused on the "functionality" of a component. It is more concerned with how a user would
interact with the component, and how the component would respond to that interaction. ❤️

ℹ️ _I'm going to use personal anecdotes._

## Problems with Enzyme

### Testing async scenarios is difficult

One of the biggest issues I've had with Enzyme is testing async scenarios. Unless you're purely working on a presentational component, most components will have some form of async natur. Something like data loading, form input and validation, etc.

You'll need to perform an action, wait for the async action to complete, then move on with your test.

This is a nightmare to do in Enzyme. Code using `setTimeout`, `setInterval`, `setImmediate`, `await Promise.resolve()` or similiar is likely trying to account for these async actions. It's HACKY... and I never liked doing it, even though there was no other way.

RTL handles this much better in two ways, maybe more.

First, RTL provides a `waitFor` utility. It allows you to wait for a condition to be true before moving on with the test. This can be used in a sync or async manner. Using it in an async manner will ensure that the async action has completed before moving on.

Second, the [`@testing-library/user-event` package](https://testing-library.com/docs/user-event/intro/) provides utility methods to help deal with user interactions. When a user interaction triggers an async action via a command like `click`, `type`, `clear`, etc., the command can be awaited to ensure the async action has completed.

This functionality is only in the newer versions of `user-event`, but they've proved amazingly helpful.

### Simulating interactions

### Setting props programmatically

### Having access to props

<script async src="https://platform.twitter.com/widgets.js"></script>
